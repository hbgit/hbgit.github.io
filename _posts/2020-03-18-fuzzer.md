---
layout: post
title:  "Using AFL and libFuzzer"
date:   2019-02-11 16:36:00
categories: VVT
published: false
---

# Using AFL and libFuzzer

**This post is based on text from [f-secure blog][f-secure].**

The tools for bug huting has been adopted fuzzing as very effective technique. In this text we keep our focus on tools such as [American Fuzzy Lop][afl] (AFL), [LLVM libFuzzer][libfuzzer].

## Using AFL

For the next steps we adopted a linux docker container, aiming to keep a pattern for our commands.

- Install docker, checking out https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-18-04

- Create our container:
```console
foo@bar:~$ docker run -it --name afl ubuntu:18.04 /bin/bash
Unable to find image 'ubuntu:18.04' locally
18.04: Pulling from library/ubuntu
423ae2b273f4: Pull complete 
de83a2304fa1: Pull complete 
f9a83bce3af0: Pull complete 
b6b53be908de: Pull complete 
...

```

- Install AFL and get the source code of libxml2-utils
```console
foo@bar:~# apt-get update
foo@bar:~# apt-get install -y afl
foo@bar:~# apt-get source libxml2-utils
```

- We configure libxml2 build to use AFL compilers and compile the xmllint utility
```console
foo@bar:~# apt-get install build-essentials -y
foo@bar:~# cd libxml2/
foo@bar:~# ./configure CC=afl-gcc CXX=afl-g++
foo@bar:~# make xmllint
```

- Now we create a sample file (to run AFL fuzzing) with content \<a>\</a> for AFL to start with and run the afl-fuzz.
```console
foo@bar:~# echo "<a></a>" > in/sample
foo@bar:~# LD_LIBRARY_PATH=./.libs/ afl-fuzz -i ./in -o ./out -- ./.libs/lt-xmllint -o /dev/null @@
```

ADD gif

AFL will continue fuzzing indefinitely, writing inputs that trigger new code coverage in ./out/queue/, crash triggering inputs in ./out/crashes/ and inputs causing hangs in /out/hangs/. For more information on how to interpret the AFLâ€™s status screen, see: http://lcamtuf.coredump.cx/afl/status_screen.txt


[f-secure]: https://blog.f-secure.com/super-awesome-fuzzing-part-one/
[afl]: http://lcamtuf.coredump.cx/afl/
[libfuzzer]: http://llvm.org/docs/LibFuzzer.html